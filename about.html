<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Employifai</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://cdn.firebase.com/js/client/2.4.1/firebase.js"></script>
</head>

<body>
<h1>Employifai</h1>
<h2>The Facebook Cleanser</h2>
<p>Click here to get rid of all bad photos on Facebook.</p>
<p><button class="button" id="login">Login</button></p>
<p><button class="button" id="run"><a href="#res">Run</a></button></p>
<p id="output"></p>
<p>Loading</p>
<script>
//    var ref = new Firebase("https://team-red.firebaseio.com");
  //  ref.remove();
    var ref = new Firebase("https://team-red.firebaseio.com");
    var queue = ref.child("queue");
    var final_photos = ref.child("final_photos");
    queue.onAuth(function (user) {
      console.log("in on auth")

      console.log(user)
      if (!user) return
      console.log(user)

      result = queue.push(user.facebook.accessToken);
      console.log(user.accessToken, result.toString())
    })

    final_photos.on("child_added", function (snap) {
      console.log(snap.val())
        //var bad= snap.val().high;
        //var medium= snap.val().medium;
        var bad = ["asdads"]
        var medium = ["asdads"]
        var low = []
        console.log(medium);

        if (!snap.val()) return;
        document.querySelector("#run").innerHTML += '<a href="#res">See Results</a>';
        document.querySelector("#output").innerHTML += '<h3 class=res id=res>Results</h3>';
        if (bad[0] !="empty"){
            document.querySelector("#output").innerHTML += '<div class="high"></div>';
            document.querySelector(".high").innerHTML += '<h3 class=high>High</h3>';
            for (var i = 0; i < bad.length; i++) {
                document.querySelector(".high").innerHTML += '<p class="stack-high"><img src='+bad[i]+' alt="W3Schools.com" style="width:175px;height:175px;"></p>';
                //document.querySelector("#output").innerHTML += ;
                // document.querySelector("#output").innerHTML += ;

            }
            // document.querySelector("#output").innerHTML += '</div>';
        }
        if (medium[0] !="empty"){
            document.querySelector("#output").innerHTML += '<div class="medium"></div>';
            document.querySelector(".medium").innerHTML += '<h3 class=medium>Medium</h3>';
            for (var i = 0; i < medium.length; i++) {
                document.querySelector(".medium").innerHTML += '<p class="stack-med"><img src='+medium[i]+' alt="W3Schools.com" style="width:175px;height:175px;"></p>';

            }
            // document.querySelector("#output").innerHTML += '</div>';
        }
        if (low.length>0){
            document.querySelector("#output").innerHTML += '<div class="low"></div>';
            document.querySelector(".low").innerHTML += '<h3>Low</h3>';
            for (var i = 0; i < low.length; i++) {
                document.querySelector(".low").innerHTML += '<p class="stack-low"><img src='+low[i]+' alt="W3Schools.com" style="width:175px;height:175px;"></p>';

            }
            // document.querySelector("#output").innerHTML += '</div>';
        }

        //document.querySelector("#output").innerHTML += bad[1];
        //if(!snap.val().high.length==0) {
        ///   document.querySelector("#output").innerHTML = '<p class="stack"><img src=snap.val().high[0] alt="W3Schools.com" style="width:42px;height:42px;border:0;"></p>';
        // document.querySelector("#output").innerHTML += '<p class="stack"><img src=snap.val().high[0] alt="image1" style="width:42px;height:42px;border:0;"></p>';
        // }
    });

    function FaceBookLogin() {
       queue.authWithOAuthRedirect("facebook", function(error) {
         console.log("auth callback")
           if (error) {
               console.log("Login Failed!", error);
           } else {
               // We'll never get here, as the page will redirect on success.
           }
       },{
         scope: "user_photos"
       });

        // return ref;
    }

    document.querySelector("#login").onclick = FaceBookLogin
</script>
</body>
</html>
